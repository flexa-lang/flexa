#ifndef VMCONSTANTS_HPP
#define VMCONSTANTS_HPP

#include <string>
#include <unordered_map>
#include <cstdint>

namespace core {

	enum OpCode : uint16_t {
		OP_RES,
		// vm control ops
		OP_PUSH_SCOPE,
		OP_POP_SCOPE,
		OP_PUSH_DEEP,
		OP_POP_DEEP,
		OP_UNWIND,
		// namespace ops
		OP_BUILTIN_LIB,
		OP_INCLUDE_NAMESPACE,
		OP_EXCLUDE_NAMESPACE,
		// value ops
		OP_POP_CONSTANT,
		OP_DUP_CONSTANT,
		OP_PUSH_UNDEFINED,
		OP_PUSH_VOID,
		OP_PUSH_TYPE,
		OP_PUSH_BOOL,
		OP_PUSH_INT,
		OP_PUSH_FLOAT,
		OP_PUSH_CHAR,
		OP_PUSH_STRING,
		OP_PUSH_FUNCTION,
		OP_INIT_ARRAY,
		OP_SET_ELEMENT,
		OP_PUSH_ARRAY,
		OP_INIT_STRUCT,
		OP_SET_FIELD,
		OP_PUSH_STRUCT,
		OP_PUSH_VALUE_FROM_STRUCT,
		// struct definition ops
		OP_STRUCT_START,
		OP_STRUCT_SET_VAR,
		OP_STRUCT_END,
		// class definition ops
		OP_CLASS_START,
		OP_CLASS_SET_VAR,
		OP_CLASS_END,
		OP_SELF_INVOKE,
		// type ops
		OP_SET_ARRAY_SIZE,
		OP_PUSH_TYPE_DEF,
		// variable ops
		OP_LOAD_VAR,
		OP_STORE_VAR,
		OP_SET_CHECK_BUILD_ARR,
		OP_LOAD_SUB_ID,
		OP_LOAD_SUB_IX,
		OP_PUSH_VAR_REF,
		OP_POP_VAR_REF,
		// function ops
		OP_FUN_START,
		OP_SET_DEFAULT_VALUE,
		OP_FUN_SET_PARAM,
		OP_FUN_START_UNPACK_PARAM,
		OP_FUN_SET_SUB_PARAM,
		OP_FUN_SET_UNPACK_PARAM, // OP_FUN_SET_PARAM equivalent for unpacked variables
		OP_FUN_END,
		OP_CALL,
		OP_RETURN,
		// coditional
		OP_TRY,
		OP_TRY_END,
		OP_THROW,
		OP_PUSH_ERROR_DESC,
		OP_PUSH_ERROR_CODE,
		OP_POP_ERROR,
		OP_GET_ITERATOR,
		OP_HAS_NEXT_ELEMENT,
		OP_NEXT_ELEMENT,
		OP_JUMP,
		OP_JUMP_IF_FALSE,
		OP_JUMP_IF_TRUE,
		// expression ops
		OP_IS_STRUCT,
		OP_IS_ARRAY,
		OP_IS_ANY,
		OP_REFID,
		OP_TYPEID,
		OP_TYPEOF,
		OP_TYPE_PARSE,
		OP_IN,
		OP_OR,
		OP_AND,
		OP_BIT_OR,
		OP_BIT_XOR,
		OP_BIT_AND,
		OP_EQL,
		OP_DIF,
		OP_LT,
		OP_LTE,
		OP_GT,
		OP_GTE,
		OP_SPACE_SHIP,
		OP_LEFT_SHIFT,
		OP_RIGHT_SHIFT,
		OP_ADD,
		OP_SUB,
		OP_MUL,
		OP_DIV,
		OP_REMAINDER,
		OP_FLOOR_DIV,
		OP_EXP,
		OP_ASSIGN,
		OP_ADD_ASSIGN,
		OP_SUB_ASSIGN,
		OP_MUL_ASSIGN,
		OP_DIV_ASSIGN,
		OP_REMAINDER_ASSIGN,
		OP_FLOOR_DIV_ASSIGN,
		OP_EXP_ASSIGN,
		OP_RIGHT_SHIFT_ASSIGN,
		OP_LEFT_SHIFT_ASSIGN,
		OP_BIT_OR_ASSIGN,
		OP_BIT_XOR_ASSIGN,
		OP_BIT_AND_ASSIGN,
		OP_INC,
		OP_DEC,
		OP_UNARY_SUB,
		OP_NOT,
		OP_BIT_NOT,
		OP_REF,
		OP_UNREF,
		OP_SKIP,
		OP_TRAP,
		OP_HALT,
		OP_SIZE,
		OP_ERROR = 0xFFFF
	};

	inline const std::unordered_map<OpCode, std::string> OP_NAMES = {
		{OP_RES, "RES"},
		// vm ops
		{OP_PUSH_SCOPE, "PUSH_SCOPE"},
		{OP_POP_SCOPE, "POP_SCOPE"},
		{OP_PUSH_DEEP, "PUSH_DEEP"},
		{OP_POP_DEEP, "POP_DEEP"},
		{OP_UNWIND, "UNWIND"},
		// namespace ops
		{OP_BUILTIN_LIB, "BUILTIN_LIB"},
		{OP_INCLUDE_NAMESPACE, "INCLUDE_NAMESPACE"},
		{OP_EXCLUDE_NAMESPACE, "EXCLUDE_NAMESPACE"},
		// value ops
		{OP_POP_CONSTANT, "POP_CONSTANT"},
		{OP_DUP_CONSTANT, "DUP"},
		{OP_PUSH_UNDEFINED, "PUSH_UNDEFINED"},
		{OP_PUSH_VOID, "PUSH_VOID"},
		{OP_PUSH_TYPE, "PUSH_TYPE"},
		{OP_PUSH_BOOL, "PUSH_BOOL"},
		{OP_PUSH_INT, "PUSH_INT"},
		{OP_PUSH_FLOAT, "PUSH_FLOAT"},
		{OP_PUSH_CHAR, "PUSH_CHAR"},
		{OP_PUSH_STRING, "PUSH_STRING"},
		{OP_PUSH_FUNCTION, "PUSH_FUNCTION"},
		{OP_INIT_ARRAY, "CREATE_ARRAY"},
		{OP_SET_ELEMENT, "SET_ELEMENT"},
		{OP_PUSH_ARRAY, "PUSH_ARRAY"},
		{OP_INIT_STRUCT, "CREATE_STRUCT"},
		{OP_SET_FIELD, "SET_FIELD"},
		{OP_PUSH_STRUCT, "PUSH_STRUCT"},
		{OP_PUSH_VALUE_FROM_STRUCT, "PUSH_VALUE_FROM_STRUCT"},
		// struct type ops
		{OP_STRUCT_START, "STRUCT_START"},
		{OP_STRUCT_SET_VAR, "STRUCT_SET_VAR"},
		{OP_STRUCT_END, "STRUCT_END"},
		// class type ops
		{OP_CLASS_START, "CLASS_START" },
		{OP_CLASS_SET_VAR, "CLASS_SET_VAR" },
		{OP_CLASS_END, "CLASS_END" },
		{OP_SELF_INVOKE, "SELF_INVOKE"},
		// type ops
		{OP_SET_ARRAY_SIZE,"SET_ARRAY_SIZE"},
		{OP_PUSH_TYPE_DEF, "PUSH_TYPE_DEF"},
		// variable ops
		{OP_LOAD_VAR, "LOAD_VAR"},
		{OP_STORE_VAR, "STORE_VAR"},
		{OP_SET_CHECK_BUILD_ARR, "SET_BUILD_ARR"},
		{OP_LOAD_SUB_ID, "LOAD_SUB_ID"},
		{OP_LOAD_SUB_IX, "LOAD_SUB_IX"},
		{OP_PUSH_VAR_REF, "PUSH_VAR_REF"},
		{OP_POP_VAR_REF, "POP_VAR_REF"},
		// function ops
		{OP_FUN_START, "FUN_START"},
		{OP_SET_DEFAULT_VALUE, "SET_DEFAULT_VALUE"},
		{OP_FUN_SET_PARAM, "FUN_SET_PARAM"},
		{OP_FUN_START_UNPACK_PARAM, "FUN_START_UNPACK_PARAM" },
		{OP_FUN_SET_SUB_PARAM, "FUN_SET_SUB_PARAM"},
		{OP_FUN_SET_UNPACK_PARAM, "FUN_SET_UNPACK_PARAM"},
		{OP_FUN_END, "FUN_END"},
		{OP_CALL, "CALL"},
		{OP_RETURN, "RETURN"},
		// coditional
		{OP_TRY, "TRY"},
		{OP_TRY_END, "TRY_END"},
		{OP_THROW, "THROW"},
		{OP_PUSH_ERROR_DESC, "PUSH_ERROR_DESC"},
		{OP_PUSH_ERROR_CODE, "PUSH_ERROR_CODE"},
		{OP_POP_ERROR, "POP_ERROR"},
		{OP_GET_ITERATOR, "GET_ITERATOR"},
		{OP_HAS_NEXT_ELEMENT, "HAS_NEXT_ELEMENT" },
		{OP_NEXT_ELEMENT, "NEXT_ELEMENT"},
		//{OP_NEXT_ELEMENT_ID, "NEXT_ELEMENT_ID"},
		{OP_JUMP, "JUMP"},
		{OP_JUMP_IF_FALSE, "JUMP_IF_FALSE"},
		{OP_JUMP_IF_TRUE, "JUMP_IF_TRUE"},
		// expression ops
		{OP_IS_STRUCT, "IS_STRUCT"},
		{OP_IS_ARRAY, "IS_ARRAY"},
		{OP_IS_ANY, "IS_ANY"},
		{OP_REFID, "REFID"},
		{OP_TYPEID, "TYPEID"},
		{OP_TYPEOF, "TYPEOF"},
		{OP_TYPE_PARSE, "TYPE_PARSE"},
		{OP_IN, "IN"},
		{OP_OR, "OR"},
		{OP_AND, "AND"},
		{OP_BIT_OR, "BIT_OR"},
		{OP_BIT_XOR, "BIT_XOR"},
		{OP_BIT_AND, "BIT_AND"},
		{OP_EQL, "EQL"},
		{OP_DIF, "DIF"},
		{OP_LT, "LT"},
		{OP_LTE, "LTE"},
		{OP_GT, "GT"},
		{OP_GTE, "GTE"},
		{OP_SPACE_SHIP, "SPACE_SHIP"},
		{OP_LEFT_SHIFT, "LEFT_SHIFT"},
		{OP_RIGHT_SHIFT, "RIGHT_SHIFT"},
		{OP_ADD, "ADD"},
		{OP_SUB, "SUB"},
		{OP_MUL, "MUL"},
		{OP_DIV, "DIV"},
		{OP_REMAINDER, "REMAINDER"},
		{OP_FLOOR_DIV, "FLOOR_DIV"},
		{OP_EXP, "EXP"},
		{OP_ASSIGN, "ASSIGN"},
		{OP_ADD_ASSIGN, "ADD_ASSIGN"},
		{OP_SUB_ASSIGN, "SUB_ASSIGN"},
		{OP_MUL_ASSIGN, "MUL_ASSIGN"},
		{OP_DIV_ASSIGN, "DIV_ASSIGN"},
		{OP_REMAINDER_ASSIGN, "REMAINDER_ASSIGN"},
		{OP_FLOOR_DIV_ASSIGN, "FLOOR_DIV_ASSIGN"},
		{OP_EXP_ASSIGN, "EXP_ASSIGN"},
		{OP_RIGHT_SHIFT_ASSIGN, "RIGHT_SHIFT_ASSIGN"},
		{OP_LEFT_SHIFT_ASSIGN, "LEFT_SHIFT_ASSIGN"},
		{OP_BIT_OR_ASSIGN, "BIT_OR_ASSIGN"},
		{OP_BIT_XOR_ASSIGN, "BIT_XOR_ASSIGN"},
		{OP_BIT_AND_ASSIGN, "BIT_AND_ASSIGN"},
		{OP_INC, "INC"},
		{OP_DEC, "DEC"},
		{OP_UNARY_SUB, "UNARY_SUB"},
		{OP_NOT, "NOT"},
		{OP_BIT_NOT, "BIT_NOT"},
		{OP_REF, "REF"},
		{OP_UNREF, "UNREF"},
		{OP_SKIP, "SKIP"},
		{OP_TRAP, "TRAP"},
		{OP_HALT, "HALT"},
		{OP_ERROR, "ERROR"}
	};

}

#endif // !VMCONSTANTS_HPP
